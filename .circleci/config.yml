version: 2.1

orbs:
  win: circleci/windows@2.4.0

jobs:
  build:
    executor:
      name: win/default
      shell: powershell.exe
    steps:
    - checkout
    - restore_cache:
        keys:
          - dotnet-packages-v1-{{ checksum ".\Hassie.ConcussionEngine.Engine\Hassie.ConcussionEngine.Engine.csproj" }}
    - run:
        name: "Fetch dependencies"
        command: dotnet.exe restore ".\Hassie.ConcussionEngine.Engine\Hassie.ConcussionEngine.Engine.csproj"
    - save_cache:
        paths:
          - C:\Users\circleci\.nuget\packages
        key: dotnet-packages-v1-{{ checksum ".\Hassie.ConcussionEngine.Engine\Hassie.ConcussionEngine.Engine.csproj" }}
    - run:
        name: "Build"
        command: dotnet.exe publish ".\Hassie.ConcussionEngine.Engine\Hassie.ConcussionEngine.Engine.csproj" -c Release -r win10-x64
